[
    {
        "check_id": "4.1.1",
        "description": "Ensure that the kubelet service file permissions are set to 600 or more restrictive (Automated)",
        "status": "FAIL",
        "reason": "Permissions 0o755 > expected 0o600",
        "audit_command": "/bin/sh -c 'if test -e /etc/systemd/system/kubelet.service.d/10-kubeadm.conf; then stat -c permissions=%a /etc/systemd/system/kubelet.service.d/10-kubeadm.conf; fi' ",
        "audit_output": "permissions=755",
        "remediation": "Run the below command (based on the file location on your system) on the each worker node.\nFor example, chmod 600 /etc/systemd/system/kubelet.service.d/10-kubeadm.conf",
        "_source_file": "cis-1.11/worker_node.yaml"
    },
    {
        "check_id": "4.1.2",
        "description": "Ensure that the kubelet service file ownership is set to root:root (Automated)",
        "status": "PASS",
        "reason": "Found ['root:root']; Did not find ['File not found']",
        "audit_command": "/bin/sh -c \"if test -e /etc/systemd/system/kubelet.service.d/10-kubeadm.conf; then stat -c %U:%G /etc/systemd/system/kubelet.service.d/10-kubeadm.conf; else echo \\\"File not found\\\"; fi\"",
        "audit_output": "root:root",
        "remediation": "Run the below command (based on the file location on your system) on the each worker node.\nFor example,\nchown root:root /etc/systemd/system/kubelet.service.d/10-kubeadm.conf",
        "_source_file": "cis-1.11/worker_node.yaml"
    },
    {
        "check_id": "4.1.3",
        "description": "If proxy kubeconfig file exists ensure permissions are set to 600 or more restrictive (Manual)",
        "status": "WARN",
        "reason": "No output from audit command, the recommendation might be manual",
        "audit_command": "/bin/sh -c 'if test -e /var/lib/kube-proxy/config.conf; then stat -c permissions=%a /var/lib/kube-proxy/config.conf; fi' ",
        "audit_output": "",
        "remediation": "Run the below command (based on the file location on your system) on the each worker node.\nFor example,\nchmod 600 /var/lib/kube-proxy/config.conf",
        "_source_file": "cis-1.11/worker_node.yaml"
    },
    {
        "check_id": "4.1.4",
        "description": "If proxy kubeconfig file exists ensure ownership is set to root:root (Manual)",
        "status": "WARN",
        "reason": "No output from audit command, the recommendation might be manual",
        "audit_command": "/bin/sh -c 'if test -e /var/lib/kube-proxy/config.conf; then stat -c %U:%G /var/lib/kube-proxy/config.conf; fi' ",
        "audit_output": "",
        "remediation": "Run the below command (based on the file location on your system) on the each worker node.\nFor example, chown root:root /var/lib/kube-proxy/config.conf",
        "_source_file": "cis-1.11/worker_node.yaml"
    },
    {
        "check_id": "4.1.5",
        "description": "Ensure that the --kubeconfig kubelet.conf file permissions are set to 600 or more restrictive (Automated)",
        "status": "PASS",
        "reason": "Permissions 0o600 \u2264 0o600",
        "audit_command": "/bin/sh -c 'if test -e /etc/kubernetes/kubelet.conf; then stat -c permissions=%a /etc/kubernetes/kubelet.conf; fi' ",
        "audit_output": "permissions=600",
        "remediation": "Run the below command (based on the file location on your system) on the each worker node.\nFor example,\nchmod 600 /etc/kubernetes/kubelet.conf",
        "_source_file": "cis-1.11/worker_node.yaml"
    },
    {
        "check_id": "4.1.6",
        "description": "Ensure that the --kubeconfig kubelet.conf file ownership is set to root:root (Automated)",
        "status": "PASS",
        "reason": "Found ['root:root']",
        "audit_command": "/bin/sh -c 'if test -e /etc/kubernetes/kubelet.conf; then stat -c %U:%G /etc/kubernetes/kubelet.conf; fi' ",
        "audit_output": "root:root",
        "remediation": "Run the below command (based on the file location on your system) on the each worker node.\nFor example,\nchown root:root /etc/kubernetes/kubelet.conf",
        "_source_file": "cis-1.11/worker_node.yaml"
    },
    {
        "check_id": "4.1.7",
        "description": "Ensure that the certificate authorities file permissions are set to 644 or more restrictive (Manual)",
        "status": "WARN",
        "reason": "Could not parse permissions",
        "audit_command": "CAFILE=$(ps -ef | grep kubelet | grep -v apiserver | grep -- --client-ca-file= | awk -F '--client-ca-file=' '{print $2}' | awk '{print $1}' | uniq)\nif test -z $CAFILE; then CAFILE=$kubeletcafile; fi\nif test -e $CAFILE; then stat -c permissions=%a $CAFILE; fi\n",
        "audit_output": "stat: missing operand\nTry 'stat --help' for more information.",
        "remediation": "Run the following command to modify the file permissions of the\n--client-ca-file chmod 644 <filename>",
        "_source_file": "cis-1.11/worker_node.yaml"
    },
    {
        "check_id": "4.1.8",
        "description": "Ensure that the client certificate authorities file ownership is set to root:root (Manual)",
        "status": "FAIL",
        "reason": "['root:root'] != root:root",
        "audit_command": "CAFILE=$(ps -ef | grep kubelet | grep -v apiserver | grep -- --client-ca-file= | awk -F '--client-ca-file=' '{print $2}' | awk '{print $1}' | uniq)\nif test -z $CAFILE; then CAFILE=$kubeletcafile; fi\nif test -e $CAFILE; then stat -c %U:%G $CAFILE; fi\n",
        "audit_output": "stat: missing operand\nTry 'stat --help' for more information.",
        "remediation": "Run the following command to modify the ownership of the --client-ca-file.\nchown root:root <filename>",
        "_source_file": "cis-1.11/worker_node.yaml"
    },
    {
        "check_id": "4.1.9",
        "description": "If the kubelet config.yaml configuration file is being used validate permissions set to 600 or more restrictive (Automated)",
        "status": "FAIL",
        "reason": "Permissions 0o644 > expected 0o600",
        "audit_command": "/bin/sh -c 'if test -e /var/lib/kubelet/config.yaml; then stat -c permissions=%a /var/lib/kubelet/config.yaml; fi' ",
        "audit_output": "permissions=644",
        "remediation": "Run the following command (using the config file location identified in the Audit step)\nchmod 600 /var/lib/kubelet/config.yaml",
        "_source_file": "cis-1.11/worker_node.yaml"
    },
    {
        "check_id": "4.1.10",
        "description": "If the kubelet config.yaml configuration file is being used validate file ownership is set to root:root (Automated)",
        "status": "PASS",
        "reason": "Found ['root:root']",
        "audit_command": "/bin/sh -c 'if test -e /var/lib/kubelet/config.yaml; then stat -c %U:%G /var/lib/kubelet/config.yaml; fi' ",
        "audit_output": "root:root",
        "remediation": "Run the following command (using the config file location identified in the Audit step)\nchown root:root /var/lib/kubelet/config.yaml",
        "_source_file": "cis-1.11/worker_node.yaml"
    },
    {
        "check_id": "4.2.1",
        "description": "Ensure that the --anonymous-auth argument is set to false (Automated)",
        "status": "FAIL",
        "reason": "['--anonymous-auth'] != False",
        "audit_command": "/bin/ps -fC kubelet",
        "audit_output": "UID          PID    PPID  C STIME TTY          TIME CMD\nroot        2892       1  0 18:55 ?        00:00:08 /usr/bin/kubelet --bootstrap-kubeconfig=/etc/kubernetes/bootstrap-kubelet.conf --kubeconfig=/etc/kubernetes/kubelet.conf --config=/var/lib/kubelet/config.yaml --container-runtime-endpoint=unix:///var/run/containerd/containerd.sock --pod-infra-container-image=registry.k8s.io/pause:3.9",
        "remediation": "If using a Kubelet config file, edit the file to set `authentication: anonymous: enabled` to\n`false`.\nIf using executable arguments, edit the kubelet service file\n/etc/systemd/system/kubelet.service.d/10-kubeadm.conf on each worker node and\nset the below parameter in KUBELET_SYSTEM_PODS_ARGS variable.\n`--anonymous-auth=false`\nBased on your system, restart the kubelet service. For example,\nsystemctl daemon-reload\nsystemctl restart kubelet.service",
        "_source_file": "cis-1.11/worker_node.yaml"
    },
    {
        "check_id": "4.2.2",
        "description": "Ensure that the --authorization-mode argument is not set to AlwaysAllow (Automated)",
        "status": "PASS",
        "reason": "['--authorization-mode'] does not contain AlwaysAllow",
        "audit_command": "/bin/ps -fC kubelet",
        "audit_output": "UID          PID    PPID  C STIME TTY          TIME CMD\nroot        2892       1  0 18:55 ?        00:00:08 /usr/bin/kubelet --bootstrap-kubeconfig=/etc/kubernetes/bootstrap-kubelet.conf --kubeconfig=/etc/kubernetes/kubelet.conf --config=/var/lib/kubelet/config.yaml --container-runtime-endpoint=unix:///var/run/containerd/containerd.sock --pod-infra-container-image=registry.k8s.io/pause:3.9",
        "remediation": "If using a Kubelet config file, edit the file to set `authorization.mode` to Webhook. If\nusing executable arguments, edit the kubelet service file\n/etc/systemd/system/kubelet.service.d/10-kubeadm.conf on each worker node and\nset the below parameter in KUBELET_AUTHZ_ARGS variable.\n--authorization-mode=Webhook\nBased on your system, restart the kubelet service. For example,\nsystemctl daemon-reload\nsystemctl restart kubelet.service",
        "_source_file": "cis-1.11/worker_node.yaml"
    },
    {
        "check_id": "4.2.3",
        "description": "Ensure that the --client-ca-file argument is set as appropriate (Automated)",
        "status": "FAIL",
        "reason": "Did not find ['--client-ca-file']",
        "audit_command": "/bin/ps -fC kubelet",
        "audit_output": "UID          PID    PPID  C STIME TTY          TIME CMD\nroot        2892       1  0 18:55 ?        00:00:08 /usr/bin/kubelet --bootstrap-kubeconfig=/etc/kubernetes/bootstrap-kubelet.conf --kubeconfig=/etc/kubernetes/kubelet.conf --config=/var/lib/kubelet/config.yaml --container-runtime-endpoint=unix:///var/run/containerd/containerd.sock --pod-infra-container-image=registry.k8s.io/pause:3.9",
        "remediation": "If using a Kubelet config file, edit the file to set `authentication.x509.clientCAFile` to\nthe location of the client CA file.\nIf using command line arguments, edit the kubelet service file\n/etc/systemd/system/kubelet.service.d/10-kubeadm.conf on each worker node and\nset the below parameter in KUBELET_AUTHZ_ARGS variable.\n--client-ca-file=<path/to/client-ca-file>\nBased on your system, restart the kubelet service. For example,\nsystemctl daemon-reload\nsystemctl restart kubelet.service",
        "_source_file": "cis-1.11/worker_node.yaml"
    },
    {
        "check_id": "4.2.4",
        "description": "Verify that if defined, the --read-only-port argument is set to 0 (Manual)",
        "status": "PASS",
        "reason": "['--read-only-port'] != 0; ['--read-only-port'] correctly unset",
        "audit_command": "/bin/ps -fC kubelet",
        "audit_output": "UID          PID    PPID  C STIME TTY          TIME CMD\nroot        2892       1  0 18:55 ?        00:00:08 /usr/bin/kubelet --bootstrap-kubeconfig=/etc/kubernetes/bootstrap-kubelet.conf --kubeconfig=/etc/kubernetes/kubelet.conf --config=/var/lib/kubelet/config.yaml --container-runtime-endpoint=unix:///var/run/containerd/containerd.sock --pod-infra-container-image=registry.k8s.io/pause:3.9",
        "remediation": "If using a Kubelet config file, edit the file to set `readOnlyPort` to 0.\nIf using command line arguments, edit the kubelet service file\n/etc/systemd/system/kubelet.service.d/10-kubeadm.conf on each worker node and\nset the below parameter in KUBELET_SYSTEM_PODS_ARGS variable.\n--read-only-port=0\nBased on your system, restart the kubelet service. For example,\nsystemctl daemon-reload\nsystemctl restart kubelet.service",
        "_source_file": "cis-1.11/worker_node.yaml"
    },
    {
        "check_id": "4.2.5",
        "description": "Ensure that the --streaming-connection-idle-timeout argument is not set to 0 (Manual)",
        "status": "PASS",
        "reason": "Unknown compare op noteq; ['--streaming-connection-idle-timeout'] correctly unset",
        "audit_command": "/bin/ps -fC kubelet",
        "audit_output": "UID          PID    PPID  C STIME TTY          TIME CMD\nroot        2892       1  0 18:55 ?        00:00:08 /usr/bin/kubelet --bootstrap-kubeconfig=/etc/kubernetes/bootstrap-kubelet.conf --kubeconfig=/etc/kubernetes/kubelet.conf --config=/var/lib/kubelet/config.yaml --container-runtime-endpoint=unix:///var/run/containerd/containerd.sock --pod-infra-container-image=registry.k8s.io/pause:3.9",
        "remediation": "If using a Kubelet config file, edit the file to set `streamingConnectionIdleTimeout` to a\nvalue other than 0.\nIf using command line arguments, edit the kubelet service file\n/etc/systemd/system/kubelet.service.d/10-kubeadm.conf on each worker node and\nset the below parameter in KUBELET_SYSTEM_PODS_ARGS variable.\n--streaming-connection-idle-timeout=5m\nBased on your system, restart the kubelet service. For example,\nsystemctl daemon-reload\nsystemctl restart kubelet.service",
        "_source_file": "cis-1.11/worker_node.yaml"
    },
    {
        "check_id": "4.2.6",
        "description": "Ensure that the --make-iptables-util-chains argument is set to true (Automated)",
        "status": "PASS",
        "reason": "['--make-iptables-util-chains'] != True; ['--make-iptables-util-chains'] correctly unset",
        "audit_command": "/bin/ps -fC kubelet",
        "audit_output": "UID          PID    PPID  C STIME TTY          TIME CMD\nroot        2892       1  0 18:55 ?        00:00:08 /usr/bin/kubelet --bootstrap-kubeconfig=/etc/kubernetes/bootstrap-kubelet.conf --kubeconfig=/etc/kubernetes/kubelet.conf --config=/var/lib/kubelet/config.yaml --container-runtime-endpoint=unix:///var/run/containerd/containerd.sock --pod-infra-container-image=registry.k8s.io/pause:3.9",
        "remediation": "If using a Kubelet config file, edit the file to set `makeIPTablesUtilChains` to `true`.\nIf using command line arguments, edit the kubelet service file\n/etc/systemd/system/kubelet.service.d/10-kubeadm.conf on each worker node and\nremove the --make-iptables-util-chains argument from the\nKUBELET_SYSTEM_PODS_ARGS variable.\nBased on your system, restart the kubelet service. For example:\nsystemctl daemon-reload\nsystemctl restart kubelet.service",
        "_source_file": "cis-1.11/worker_node.yaml"
    },
    {
        "check_id": "4.2.7",
        "description": "Ensure that the --hostname-override argument is not set (Manual)",
        "status": "PASS",
        "reason": "['--hostname-override'] correctly unset",
        "audit_command": "/bin/ps -fC kubelet",
        "audit_output": "UID          PID    PPID  C STIME TTY          TIME CMD\nroot        2892       1  0 18:55 ?        00:00:08 /usr/bin/kubelet --bootstrap-kubeconfig=/etc/kubernetes/bootstrap-kubelet.conf --kubeconfig=/etc/kubernetes/kubelet.conf --config=/var/lib/kubelet/config.yaml --container-runtime-endpoint=unix:///var/run/containerd/containerd.sock --pod-infra-container-image=registry.k8s.io/pause:3.9",
        "remediation": "Edit the kubelet service file /etc/systemd/system/kubelet.service.d/10-kubeadm.conf\non each worker node and remove the --hostname-override argument from the\nKUBELET_SYSTEM_PODS_ARGS variable.\nBased on your system, restart the kubelet service. For example,\nsystemctl daemon-reload\nsystemctl restart kubelet.service",
        "_source_file": "cis-1.11/worker_node.yaml"
    },
    {
        "check_id": "4.2.8",
        "description": "Ensure that the eventRecordQPS argument is set to a level which ensures appropriate event capture (Manual)",
        "status": "PASS",
        "reason": "Could not parse numeric value for comparison or Target not found; ['--event-qps'] correctly unset",
        "audit_command": "/bin/ps -fC kubelet",
        "audit_output": "UID          PID    PPID  C STIME TTY          TIME CMD\nroot        2892       1  0 18:55 ?        00:00:08 /usr/bin/kubelet --bootstrap-kubeconfig=/etc/kubernetes/bootstrap-kubelet.conf --kubeconfig=/etc/kubernetes/kubelet.conf --config=/var/lib/kubelet/config.yaml --container-runtime-endpoint=unix:///var/run/containerd/containerd.sock --pod-infra-container-image=registry.k8s.io/pause:3.9",
        "remediation": "If using a Kubelet config file, edit the file to set `eventRecordQPS` to an appropriate level.\nIf using command line arguments, edit the kubelet service file\n/etc/systemd/system/kubelet.service.d/10-kubeadm.conf on each worker node and\nset the below parameter in KUBELET_SYSTEM_PODS_ARGS variable.\nBased on your system, restart the kubelet service. For example,\nsystemctl daemon-reload\nsystemctl restart kubelet.service",
        "_source_file": "cis-1.11/worker_node.yaml"
    },
    {
        "check_id": "4.2.9",
        "description": "Ensure that the --tls-cert-file and --tls-private-key-file arguments are set as appropriate (Manual)",
        "status": "FAIL",
        "reason": "Did not find ['--tls-cert-file']; Did not find ['--tls-private-key-file']",
        "audit_command": "/bin/ps -fC kubelet",
        "audit_output": "UID          PID    PPID  C STIME TTY          TIME CMD\nroot        2892       1  0 18:55 ?        00:00:08 /usr/bin/kubelet --bootstrap-kubeconfig=/etc/kubernetes/bootstrap-kubelet.conf --kubeconfig=/etc/kubernetes/kubelet.conf --config=/var/lib/kubelet/config.yaml --container-runtime-endpoint=unix:///var/run/containerd/containerd.sock --pod-infra-container-image=registry.k8s.io/pause:3.9",
        "remediation": "If using a Kubelet config file, edit the file to set `tlsCertFile` to the location\nof the certificate file to use to identify this Kubelet, and `tlsPrivateKeyFile`\nto the location of the corresponding private key file.\nIf using command line arguments, edit the kubelet service file\n/etc/systemd/system/kubelet.service.d/10-kubeadm.conf on each worker node and\nset the below parameters in KUBELET_CERTIFICATE_ARGS variable.\n--tls-cert-file=<path/to/tls-certificate-file>\n--tls-private-key-file=<path/to/tls-key-file>\nBased on your system, restart the kubelet service. For example,\nsystemctl daemon-reload\nsystemctl restart kubelet.service",
        "_source_file": "cis-1.11/worker_node.yaml"
    },
    {
        "check_id": "4.2.10",
        "description": "Ensure that the --rotate-certificates argument is not set to false (Automated)",
        "status": "PASS",
        "reason": "['--rotate-certificates'] != True; ['--rotate-certificates'] correctly unset",
        "audit_command": "/bin/ps -fC kubelet",
        "audit_output": "UID          PID    PPID  C STIME TTY          TIME CMD\nroot        2892       1  0 18:55 ?        00:00:08 /usr/bin/kubelet --bootstrap-kubeconfig=/etc/kubernetes/bootstrap-kubelet.conf --kubeconfig=/etc/kubernetes/kubelet.conf --config=/var/lib/kubelet/config.yaml --container-runtime-endpoint=unix:///var/run/containerd/containerd.sock --pod-infra-container-image=registry.k8s.io/pause:3.9",
        "remediation": "If using a Kubelet config file, edit the file to add the line `rotateCertificates` to `true` or\nremove it altogether to use the default value.\nIf using command line arguments, edit the kubelet service file\n/etc/systemd/system/kubelet.service.d/10-kubeadm.conf on each worker node and\nremove --rotate-certificates=false argument from the KUBELET_CERTIFICATE_ARGS\nvariable.\nBased on your system, restart the kubelet service. For example,\nsystemctl daemon-reload\nsystemctl restart kubelet.service",
        "_source_file": "cis-1.11/worker_node.yaml"
    },
    {
        "check_id": "4.2.11",
        "description": "Verify that the RotateKubeletServerCertificate argument is set to true (Manual)",
        "status": "PASS",
        "reason": "['RotateKubeletServerCertificate'] does not contain False; ['RotateKubeletServerCertificate'] correctly unset",
        "audit_command": "/bin/ps -fC kubelet",
        "audit_output": "UID          PID    PPID  C STIME TTY          TIME CMD\nroot        2892       1  0 18:55 ?        00:00:08 /usr/bin/kubelet --bootstrap-kubeconfig=/etc/kubernetes/bootstrap-kubelet.conf --kubeconfig=/etc/kubernetes/kubelet.conf --config=/var/lib/kubelet/config.yaml --container-runtime-endpoint=unix:///var/run/containerd/containerd.sock --pod-infra-container-image=registry.k8s.io/pause:3.9",
        "remediation": "Edit the kubelet service file /etc/systemd/system/kubelet.service.d/10-kubeadm.conf\non each worker node and set the below parameter in KUBELET_CERTIFICATE_ARGS variable.\n--feature-gates=RotateKubeletServerCertificate=true\nBased on your system, restart the kubelet service. For example:\nsystemctl daemon-reload\nsystemctl restart kubelet.service",
        "_source_file": "cis-1.11/worker_node.yaml"
    },
    {
        "check_id": "4.2.12",
        "description": "Ensure that the Kubelet only makes use of Strong Cryptographic Ciphers (Manual)",
        "status": "WARN",
        "reason": "Could not parse values for valid_elements",
        "audit_command": "/bin/ps -fC kubelet",
        "audit_output": "UID          PID    PPID  C STIME TTY          TIME CMD\nroot        2892       1  0 18:55 ?        00:00:08 /usr/bin/kubelet --bootstrap-kubeconfig=/etc/kubernetes/bootstrap-kubelet.conf --kubeconfig=/etc/kubernetes/kubelet.conf --config=/var/lib/kubelet/config.yaml --container-runtime-endpoint=unix:///var/run/containerd/containerd.sock --pod-infra-container-image=registry.k8s.io/pause:3.9",
        "remediation": "If using a Kubelet config file, edit the file to set `tlsCipherSuites` to\nTLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305,TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384,TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305,TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384,TLS_RSA_WITH_AES_256_GCM_SHA384,TLS_RSA_WITH_AES_128_GCM_SHA256\nor to a subset of these values.\nIf using executable arguments, edit the kubelet service file\n/etc/systemd/system/kubelet.service.d/10-kubeadm.conf on each worker node and\nset the --tls-cipher-suites parameter as follows, or to a subset of these values.\n--tls-cipher-suites=TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305,TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384,TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305,TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384,TLS_RSA_WITH_AES_256_GCM_SHA384,TLS_RSA_WITH_AES_128_GCM_SHA256\nBased on your system, restart the kubelet service. For example:\nsystemctl daemon-reload\nsystemctl restart kubelet.service",
        "_source_file": "cis-1.11/worker_node.yaml"
    },
    {
        "check_id": "4.2.13",
        "description": "Ensure that a limit is set on pod PIDs (Manual)",
        "status": "FAIL",
        "reason": "Did not find ['--pod-max-pids']",
        "audit_command": "/bin/ps -fC kubelet",
        "audit_output": "UID          PID    PPID  C STIME TTY          TIME CMD\nroot        2892       1  0 18:55 ?        00:00:08 /usr/bin/kubelet --bootstrap-kubeconfig=/etc/kubernetes/bootstrap-kubelet.conf --kubeconfig=/etc/kubernetes/kubelet.conf --config=/var/lib/kubelet/config.yaml --container-runtime-endpoint=unix:///var/run/containerd/containerd.sock --pod-infra-container-image=registry.k8s.io/pause:3.9",
        "remediation": "Decide on an appropriate level for this parameter and set it,\neither via the --pod-max-pids command line parameter or the PodPidsLimit configuration file setting.",
        "_source_file": "cis-1.11/worker_node.yaml"
    },
    {
        "check_id": "4.2.14",
        "description": "Ensure that the --seccomp-default parameter is set to true (Manual)",
        "status": "FAIL",
        "reason": "Did not find ['--seccomp-default']",
        "audit_command": "/bin/ps -fC kubelet",
        "audit_output": "UID          PID    PPID  C STIME TTY          TIME CMD\nroot        2892       1  0 18:55 ?        00:00:08 /usr/bin/kubelet --bootstrap-kubeconfig=/etc/kubernetes/bootstrap-kubelet.conf --kubeconfig=/etc/kubernetes/kubelet.conf --config=/var/lib/kubelet/config.yaml --container-runtime-endpoint=unix:///var/run/containerd/containerd.sock --pod-infra-container-image=registry.k8s.io/pause:3.9",
        "remediation": "Set the parameter, either via the --seccomp-default command line parameter or the\nseccompDefault configuration file setting.\nBy default the seccomp profile is not enabled.",
        "_source_file": "cis-1.11/worker_node.yaml"
    },
    {
        "check_id": "4.2.15",
        "description": "Ensure that the --IPAddressDeny is set to any (Manual)",
        "status": "FAIL",
        "reason": "Did not find ['--IPAddressDeny']",
        "audit_command": "/bin/ps -fC kubelet",
        "audit_output": "UID          PID    PPID  C STIME TTY          TIME CMD\nroot        2892       1  0 18:55 ?        00:00:08 /usr/bin/kubelet --bootstrap-kubeconfig=/etc/kubernetes/bootstrap-kubelet.conf --kubeconfig=/etc/kubernetes/kubelet.conf --config=/var/lib/kubelet/config.yaml --container-runtime-endpoint=unix:///var/run/containerd/containerd.sock --pod-infra-container-image=registry.k8s.io/pause:3.9",
        "remediation": "Configuring the setting IPAddressDeny=any will deny service to any IP address not specified in the complimentary setting IPAddressAllow configuration parameter (\nIPAddressDeny=any\nIPAddressAllow={{ kubelet_secure_addresses }}\n*Note\n  kubelet_secure_addresses: \"localhost link-local {{ kube_pods_subnets |regex_replace(',', ' ') }} {{ kube_node_addresses }} {{ loadbalancer_apiserver.address | default('')\"\nBy default IPAddressDeny is not enabled.",
        "_source_file": "cis-1.11/worker_node.yaml"
    },
    {
        "check_id": "4.3.1",
        "description": "Ensure that the kube-proxy metrics service is bound to localhost (Automated)",
        "status": "PASS",
        "reason": "['--metrics-bind-address'] does not contain 127.0.0.1; ['--metrics-bind-address'] correctly unset",
        "audit_command": "/bin/ps -fC $proxybin",
        "audit_output": "error: list of command names must follow -C\n\nUsage:\n ps [options]\n\n Try 'ps --help <simple|list|output|threads|misc|all>'\n  or 'ps --help <s|l|o|t|m|a>'\n for additional help text.\n\nFor more details see ps(1).",
        "remediation": "Modify or remove any values which bind the metrics service to a non-localhost address.\nThe default value is 127.0.0.1:10249.",
        "_source_file": "cis-1.11/worker_node.yaml"
    }
]
